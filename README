osCommerce PostFinance E-Payment Module


A B O U T
---------

This is the new PostFinance E-Payment Module for the new Swiss PostFinance payment gateway that has been released by PostFinance in November 2008. 

With the PostFinance account, your customers pay for their purchases directly from their computer or mobile phone. Payments with PostFinance Card or PostFinance e-finance.

Features: E-payment: Payment solution and payment methods for online purchases

* Payment methods: PostFinance Card or PostFinance e-finance
* Payment via the Internet using a computer or mobile phone
* Direct debit of the PostFinance account
* Secure, encrypted data transfer (min. 128 bit)
* No more need to issue invoices
* No fixed costs

PostFinance Card and PostFinance e-finance are free of charge. You only require a PostFinance business account.




I N S T A L L A T I O N
-----------------------

a.)

Extract then the ZIP archive and upload the contents of the catalog folder to your osCommerce store, i.e.

catalog/ext/modules/payment/postfinance/postfinance_ipn.php
catalog/includes/languages/english/modules/payment/postfinance.php
catalog/includes/languages/espanol/modules/payment/postfinance.php
catalog/includes/languages/german/modules/payment/postfinance.php
catalog/includes/modules/payment/postfinance.php



b.)

Login to your store admin and go to Modules / Payment / PostFinance and install the module by clicking on the install button on the right hand side.




C O N F I G U R A T I O N
-------------------------

a.)

Login to to the demo environment of the PostFinance backend located at 

https://e-payment.postfinance.ch/ncol/test/admin_POSTFINANCE.asp

and go to 

Configuration / Technical information 

and set the following parameters - replace {yourdomain.ch} with your real domain name!



1.1. method: POST

2.2. URL of the merchant page containing the payment form that will call the page: http://www.{yourdomain.ch}/catalog/checkout_confirmation.php

3.2. SHA-1 Signature: Use any combination of characters you like and use the same string in the PostFinance back office

4.4. Feedback data checking: same as 3.2

4.5. Redirection URL's: select the checkbox

5. Client's dialog management: all checkboxes under 5 should be selected


Note: All other configuration options can be left as they are.



b.)

Login into admin section and select Modules -> Payment -> PostFinance Debit Direct. Select Install.

2. Select Edit and set the following values for post finance login, payment page settings and return,accept,decline url etc...

Activate PostFinance module	:	True

Merchant ID (PSPID)		:	Your merchant ID, the test ID is e.g. openstreamDEMO

User ID (optional)		:	Optional (additional users can be created in the PostFinance back office)

Merchant/User Password		:	Sent to you by PostFinance

SHA-1 Signature 		:	Use any combination of characters you like and use the same string in the PostFinance 
                                        back office (see CONFIGURATION 3.2. SHA-1 Signature)

Default Transaction Currency	:	CHF

State of order			:	The order state that is assigned after successful payment

Sort				:	Sort order of the payment module on the store's payment page

Title and header of the page	:	[YOUR TITLE FOR POST FINANCE PAYMENT PAGE], optional

Background color		:	[YOUR BACKGROUND COLOR], optional

Text color			:	[YOUR TEXT COLOR], optional

Table background color		:	[YOUR TABLE BACKGROUND COLOR], optional

Table text color		:	[YOUR TABLE TEXT COLOR], optional

Button background color		:	[YOUR BUTTON BACKGROUND COLOR], optional

Button text color		:	[YOUR BUTTON COLOR], optional

Font family			:	[YOUR'S FONT FAMILY], optional

Logo URL			:	URL/filename of the logo you want to display at the top of the payment page next to the title.
					The URL must be absolute (contain the full path), it cannot be relative. The logo needs to be stored on a
					secure server (see Chapter 7.3). If you do not have a secure environment to store your image,
					you can send a JPG or GIF file (and your PSPID) to merchanthelp@postfinance.ch (only for production 
					accounts since this is a paying option! Please activate the “Logo Hosting” 
					option in your Account > Options page before sending us your logo). 
					If the logo is stored on our servers, you only need to enter the filename, not the whole URL.


Accept Url			:	http://www.{yourdomain.ch}/catalog/checkout_process.php

Decline Url			:	http://www.{yourdomain.ch}/catalog/checkout_process.php 

Exception Url			:	http://www.{yourdomain.ch}/catalog/checkout_process.php

Cancel Url			:	http://www.{yourdomain.ch}/catalog/checkout_process.php

Catalog Url			:	http://www.{yourdomain.ch}/catalog/

Home Url			:	http://www.{yourdomain.ch}

Payment Zone			:	

Debug E-Mail Address		:	When a payment is declined, cancelled or throws an execption, the system will send a mail to this mail address.

Mod				:	1 => TEST,  0 => LIVE / PRODUCTION

Update your changes.






Note: After configuring the payment module in osCommerce admin and in the PostFinance backoffice, make a test order to see if everything is working correctly.



c.)

If you have tested successfully in the demo environment, login to the production environment at

https://e-payment.postfinance.ch/ncol/prod/admin_POSTFINANCE.asp

with your live username (PSPID) which is usually equal to the demo username WITHOUT the letters TEST and repeat the configuration steps under CONFIGURATION a.

Then go to the payment modules configuration in osCommerce and switch from TEST to LIVE under "Mod" (last config variable at the bottom)



S U P P O R T
-------------

English: http://forums.oscommerce.com/index.php?showtopic=325141

German:  http://forums.oscommerce.de/index.php?showtopic=67135

Credits: Openstream Internet Solutions, Zurich/Switzerland
         http://www.openstream.ch
